[]
args.client_id_list = None
training_type != FEDML_TRAINING_PLATFORM_CROSS_DEVICE and training_type != FEDML_TRAINING_PLATFORM_CROSS_SILO
bsize is 128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:01:40] [INFO] [__init__.py:109:print_args] ==== args = {'yaml_config_file': '/Users/vscheltjens/Documents/PhD/Projects/eicu-cl-req/distributed_training/config.yml', 'run_id': '0', 'rank': 0, 'local_rank': 0, 'node_rank': 0, 'role': 'client', 'central_training': 0, 'yaml_paths': ['/Users/vscheltjens/Documents/PhD/Projects/eicu-cl-req/distributed_training/config.yml'], 'training_type': 'simulation', 'random_seed': 0, 'dataset': 'ICU', 'data_cache_dir': '/Users/vscheltjens/Documents/PhD/Projects/eicu-cl-req/eICU_Data/', 'partition_method': 'hetero', 'partition_alpha': 0.5, 'model': 'GRU', 'input_dim': 128, 'hidden_dim': 32, 'num_layers': 2, 'output_dim': 1, 'dropout_prob': 0.05, 'dist_model_dir': '/Users/vscheltjens/Documents/PhD/Projects/eicu-cl-req/distributed_training/', 'central_model_dir': '/Users/vscheltjens/Documents/PhD/Projects/eicu-cl-req/central_training/', 'federated_optimizer': 'FedAvg', 'client_id_list': '[]', 'client_num_in_total': 5, 'client_num_per_round': 3, 'comm_round': 5, 'epochs': 2, 'batch_size': 128, 'client_optimizer': 'adamw', 'learning_rate': 0.005, 'weight_decay': 0.005, 'recruitment': False, 'central_epochs': 15, 'frequency_of_the_test': 1, 'using_gpu': False, 'gpu_id': 0, 'backend': 'sp', 'log_file_dir': '/Users/vscheltjens/fedml-server/fedml/logs', 'enable_wandb': True, 'wandb_key': '8d579c56c0eda8929353aac11d399b96e5aa9e71', 'wandb_entity': 'vs-health', 'wandb_project': 'federated_gru_eicu', 'central_wandb_project': 'recr_central_training', 'worker_num': 3, 'sys_perf_profiling': True, 'config_version': 'release', 'current_running_dir': '/Users/vscheltjens/fedml-client', 'os_name': 'MacOS', 'version': 'release', 'device_id': '0xC02F52N9MD6R', 'cloud_region': '', 'mqtt_config_path': '', 's3_config_path': '', 'log_server_url': 'https://open.fedml.ai/fedmlLogsServer/logs/update'}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:01:40] [INFO] [ml_engine_adapter.py:147:get_torch_device] args = <fedml.arguments.Arguments object at 0x7fecd0040f70>, using_gpu = False, device_id = 0, device_type = cpu
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:01:40] [INFO] [device.py:48:get_device] device = cpu
Loaded Global dataloaders
24698 24698
covered hospital 0
covered hospital 1
covered hospital 2
covered hospital 3
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:43:__init__] model = GRUModel(
  (gru): GRU(128, 32, num_layers=2, batch_first=True, dropout=0.05)
  (fc): Linear(in_features=32, out_features=1, bias=True)
  (gru_dropout): Dropout(p=0.05, inplace=False)
  (batch_norm): BatchNorm1d(1, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  (relu): ReLU()
)
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:46:__init__] self.model_trainer = <fedml.ml.trainer.icu_trainer.ModelTrainerICU object at 0x7fecc2144520>
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:55:_setup_clients] ############setup_clients (START)#############
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:67:_setup_clients] ############setup_clients (END)#############
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:70:train] self.model_trainer = <fedml.ml.trainer.icu_trainer.ModelTrainerICU object at 0x7fecc2144520>
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:77:train] ################Communication round : 0
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:142:_client_sampling] client_indexes = [2 0 1]
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:16] [INFO] [fedavg_api.py:88:train] client_indexes = [2 0 1]
covered hospital 4
reached target point: model and data loaded -----> start training federated
120
120
57
57
128
128
128
128
128
128
128
53
128
128
128
128
128
128
128
53
57
57
128
128
128
128
128
128
128
53
128
128
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:18] [INFO] [fedavg_api.py:186:_local_test_on_all_clients] ################local_test_on_all_clients : 0
128
128
128
53
120
120
25
25
117
117
120
120
128
128
128
128
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:21] [INFO] [fedavg_api.py:240:_local_test_on_all_clients] {'train_MAE': 2.3762897729873655, 'training_loss': 0.6627389147877694}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:21] [INFO] [fedavg_api.py:249:_local_test_on_all_clients] {'test_MAE': 2.3957270979881287, 'test_loss': 0.6667731836438179}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:21] [INFO] [fedavg_api.py:77:train] ################Communication round : 1
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:21] [INFO] [fedavg_api.py:142:_client_sampling] client_indexes = [2 1 4]
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:21] [INFO] [fedavg_api.py:88:train] client_indexes = [2 1 4]
128
53
128
128
128
128
128
128
128
53
117
117
57
57
128
128
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:23] [INFO] [fedavg_api.py:186:_local_test_on_all_clients] ################local_test_on_all_clients : 1
128
128
128
53
128
128
128
128
128
128
128
53
120
120
25
25
117
117
120
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:26] [INFO] [fedavg_api.py:240:_local_test_on_all_clients] {'train_MAE': 2.228438490629196, 'training_loss': 0.5721936881542206}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:26] [INFO] [fedavg_api.py:249:_local_test_on_all_clients] {'test_MAE': 2.216625767946243, 'test_loss': 0.5686983034014702}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:26] [INFO] [fedavg_api.py:77:train] ################Communication round : 2
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:26] [INFO] [fedavg_api.py:142:_client_sampling] client_indexes = [2 4 1]
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:26] [INFO] [fedavg_api.py:88:train] client_indexes = [2 4 1]
120
117
117
128
128
128
128
128
128
128
53
128
128
128
128
128
128
128
53
57
57
128
128
128
128
128
128
128
53
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:28] [INFO] [fedavg_api.py:186:_local_test_on_all_clients] ################local_test_on_all_clients : 2
128
128
128
128
128
53
120
120
25
25
117
117
25
25
117
117
128
128
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:31] [INFO] [fedavg_api.py:240:_local_test_on_all_clients] {'train_MAE': 2.573393040895462, 'training_loss': 0.8098990440368652}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:31] [INFO] [fedavg_api.py:249:_local_test_on_all_clients] {'test_MAE': 2.5943941295146944, 'test_loss': 0.8149181321263314}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:31] [INFO] [fedavg_api.py:77:train] ################Communication round : 3
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:31] [INFO] [fedavg_api.py:142:_client_sampling] client_indexes = [3 4 1]
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:31] [INFO] [fedavg_api.py:88:train] client_indexes = [3 4 1]
128
128
128
53
128
128
128
128
128
128
128
53
57
57
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:33] [INFO] [fedavg_api.py:186:_local_test_on_all_clients] ################local_test_on_all_clients : 3
128
128
128
128
128
53
128
128
128
128
128
128
128
53
120
120
25
25
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:36] [INFO] [fedavg_api.py:240:_local_test_on_all_clients] {'train_MAE': 2.687902694940567, 'training_loss': 0.9122173920273781}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:36] [INFO] [fedavg_api.py:249:_local_test_on_all_clients] {'test_MAE': 2.6803646981716156, 'test_loss': 0.9117240384221077}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:36] [INFO] [fedavg_api.py:77:train] ################Communication round : 4
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:36] [INFO] [fedavg_api.py:142:_client_sampling] client_indexes = [0 3 1]
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:36] [INFO] [fedavg_api.py:88:train] client_indexes = [0 3 1]
117
117
57
57
25
25
128
128
128
128
128
128
128
53
128
128
128
128
128
128
128
53
57
57
128
128
128
128
128
128
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:39] [INFO] [fedavg_api.py:186:_local_test_on_all_clients] ################local_test_on_all_clients : 4
128
53
128
128
128
128
128
128
128
53
120
120
25
25
117
117
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:41] [INFO] [fedavg_api.py:240:_local_test_on_all_clients] {'train_MAE': 2.628994566202164, 'training_loss': 0.8546310395002366}
[FedML-Server(0) @device-id-0] [Sun, 15 Jan 2023 17:02:41] [INFO] [fedavg_api.py:249:_local_test_on_all_clients] {'test_MAE': 2.6280633389949797, 'test_loss': 0.8533407330513001}
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
128
34
[2.9773293082247076, 0.6825568276582304, 26.74778179778266, 0.9821132863919759, -0.5956902823093391]
Performance against test: {'final_test_MAE': 2.9773293082247076, 'final_test_MAPE': 0.6825568276582304, 'final_test_MSE': 26.74778179778266, 'final_test_MSLE': 0.9821132863919759, 'final_test_R_sq': -0.5956902823093391}